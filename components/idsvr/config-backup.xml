<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.WFRMcXBjNjlicHIwNm9aUQ==.L2lIpbK0eKOmCikOeJ7jig==.xLYRoX8DNW3qGx4o38PX8zTI_FIHWv8m4G3MFRM3sbjrliCiUFFP1Jj0LI5vWHU1jXfNlHMAKC2Bwy6295rsCYVC8rSMOHa4h0n5CJ8K2EE=.zXrxumqjO_jNAuXOr_T5GWWS1BfMju9nUJGo_eXE3_I=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-dynamic-client-registration</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
          <endpoints>um-admin</endpoints>
          <endpoints>user-graphql-admin</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authentication-actions>
            <authentication-action>
              <id>dbug</id>
              <debug-attribute xmlns="https://curity.se/ns/ext-conf/debug-attribute"/>
            </authentication-action>
            <authentication-action>
              <id>get-user-attributes</id>
              <data-source-transformer xmlns="https://curity.se/ns/ext-conf/data-source-transformer">
                <attribute-data-source>
                  <data-source>default-datasource</data-source>
                </attribute-data-source>
              </data-source-transformer>
            </authentication-action>
          </authentication-actions>
          <authenticators>
            <authenticator>
              <id>username-password</id>
              <authentication-context-class-reference>iggbom</authentication-context-class-reference>
              <authentication-actions>
                <login>get-user-attributes</login>
              </authentication-actions>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authorization-manager>opa-authz-mngr</authorization-manager>
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <default-scope-claim>group</default-scope-claim>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>group</name>
              <value-provided-by>auth-subject-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>attributes</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBKU09OLnBhcnNlKGF0dHJpYnV0ZXMuYXR0cmlidXRlcykuZ3JvdXA7Cn0=</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>auth-subject-claims-provider</id>
              <authentication-subject-claims-provider xmlns="https://curity.se/ns/ext-conf/authentication-subject-claims-provider"/>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <access_token>
                  <claim>group</claim>
                </access_token>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>opa-demo</id>
                <secret>$5$.Tugfmc5z1PCWNOZ$HPd5hWY6XkMYdzc1crl4pgv83S.bKl4z6QDjf/I9G61</secret>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <access-token-ttl>6000</access-token-ttl>
                <user-authentication>
                </user-authentication>
                <allowed-origins>https://oauth.tools</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
          <dynamic-client-registration>
            <client-data-source>default-datasource</client-data-source>
            <non-templatized>
              <capabilities>
                <code/>
                <implicit/>
                <resource-owner-password-credentials/>
                <client-credentials/>
              </capabilities>
              <scopes>
                <all/>
              </scopes>
              <authenticators>
                <all/>
              </authenticators>
              <client-authentication-method>
                <secret>
                </secret>
              </client-authentication-method>
              <authenticate-user-by>opa-demo</authenticate-user-by>
            </non-templatized>
            <client-management>
            </client-management>
          </dynamic-client-registration>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-dynamic-client-registration</id>
          <uri>/token-service/oauth-registration</uri>
          <endpoint-kind>oauth-dynamic-client-registration</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>um</id>
      <type xmlns:um="https://curity.se/ns/conf/profile/user-management">um:user-management-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <user-management-service xmlns="https://curity.se/ns/conf/profile/user-management">
          <api-authentication>
            <oauth-service>token-service</oauth-service>
          </api-authentication>
          <authorization-manager>opa-authz-mngr</authorization-manager>
          <user-account-data-source>default-datasource</user-account-data-source>
          <devices-data-source>default-datasource</devices-data-source>
          <token-data-source>default-datasource</token-data-source>
          <credential-management>
            <credential-manager>default-credential-manager</credential-manager>
          </credential-management>
          <graphql-schema>
            <additional-account-attribute>
              <name>group</name>
              <type>String</type>
            </additional-account-attribute>
          </graphql-schema>
        </user-management-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>um-admin</id>
          <uri>/um/admin</uri>
          <endpoint-kind>um-api</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>user-graphql-admin</id>
          <uri>/um/graphql/admin</uri>
          <client-authentication>disallow</client-authentication>
          <endpoint-kind>um-graphql-api</endpoint-kind>
        </endpoint>
      </endpoints>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <http>
      <client>
        <id>opa-http-client</id>
        <scheme>http</scheme>
      </client>
    </http>
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT account_id, username, email, phone, attributes, active, created, updated FROM accounts WHERE accounts.username = :subject</attribute-query>
          <connection-string>data:text/plain;aes,v:S.ZGF6cFhIV0p6ZTZQdlFPeQ==.tyQa8IBQ52y4MnooWhA0Rg==.4DkBz4rbCfKkTdSRVTN5FiTtuWmwChYtl9F9kwJhUUd995U3khAfMBCktw4yqa_1.bTM06h1y3Z7R8e1-ctw_Q_PIuofCgsaI-yRVifTCzrg=</connection-string>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.UDRYSzZWR2JVZGxITHZvRA==.aZ2XMtYLOr5kd8eGfafCgg==.IQjb1eDTzVd3AeQux8z9Ng==.VeiaPxBb-kurjsAD44Vmfq9CGadD98YdUxnjPCJGgyE=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.RjhGeWp2Wmw5UklhQzZvRQ==.s16wtjPHV_G7UrNgdDbF0g==.f9VvYfetkU1bSDKiy-PLe4wdkVrPAM-9c6s-H-rZYxzNSZi6Hbg0aTX4Ni3i--Rjtj97LQz9GljFiDJ2QnhPvOLXdYvflyMPbgOCgi0FKnvwDwmjA40qeOnOF1oANaP_pASCuW6bQolknR38cnf4k7OEnXGa-beIJfoo6rE9S9Fv9fQD83DE-7nMHMObDWjBP3M5J97RxGSEP0YZilHc56QQJ_PIjmw1G-9fkpE_mPSsL1Tsmho8T0LtzLAo6rtOlWY4A_ouzf1zWzkEheLIqFSveHNRf3RAqV6FPBPENcRc3nLoTfoi3J7WocunOhfcPeGc6pAjLTjxz5Y-1vnOJeXoswenxfu7M98zNHL_fqEUkzYP2kPh1ObgAeA3jnBEg1P2Af2YtKUWj7iqR2n3r2bbmooIFrpWr9MRKZwMxK--uQ_qrwnpvfvQ5EWMEVa2mxs6rbvN4TtgQQ4tD60zEMhGdKoOyedvkHlOVn9vu08O5XnziTZopjcu-G9dStSsREkh3j47KxcM9SC8UfF8geJYpe8-D3DrdfXpLLZ8q-j3gCF7UelLR_xt_zqhTNrFLKTwvQ6nOFpdy1rDi0H-BFn6I5WdrKd7cda6QZGm_K2zhYkHrbmb2po6heE4cxt5ZyVkzhjgubKm5KOeJ9e8Dno70palFd8fMxIEOuGecVUCCb3uRe8jZGPyqC7yDQgEmsof0m526U2qg6mlXjLCJrbQ4ckZaHgBFuXKrebvZ6mM0tUwecd11UNPlU0fG8B22tleCXPOvbZyXl9cx_VhqJ3AEkDRMF-7NvHfLxBoUz6vJuCB8OC974DSZc6MFjYD9dAejV3TlRBnyWmYT_pDmDnaQnvkocwEeDxwQd2gK4bo6vkduCyDGdLaxyoqBT4erGpbDy9zJSmmv-riFswpMAZVKU_Qt3bMi30VFcUpm8QxtA3QjAOa-cgTjjKwpea08bgpvV6C5NwqDE34Ip1G3j-tFqYHWzisCVqX_I9Vsw9yRV2nv3YSXWEoFySjQDv-2YPe3gEfJJoxFpQusU2Uy8rxpJWnGgOOIbaxg5pXyVN3SKnhqgJ_05xTrl5GHnEfVROf7z4dd0aqaK1GlDmMOp1tAlzO8eQ4NmrIjrcNDap3dKCWVpDf9SZR1QX8AICsud24o91Ei6TCsLQb1GZrwXCeFcrBZzS1IrgscHfQ7cWYFbLT9M9-AN9AjthB5C881f_Jfknm3_3UMwBxld6oL3ZNkSygm8dxOnlAFgjZiRKVpEbKK-AivLYTgfCO-iCOdnkOYXWV1njwnK6cz0XCmlK2chiV0aYBzS-lUEvQuopVSB9bKuVASmCYSmCpylWBPrU4YChoU6TzUYqyeNYfrJfd0JEf8XzR2uHxHLwzljFT0OXRdFnFaWChumIJWS8xXnh6Kf4So2Vv6bNdW5F3K7iruRIejDfxsoVruCQpW0ky4053tIYdV9ewpUxuXVf2cK35VDA3iN_Wvq4Taoaka0yNVnJhyKlFt1cZtoe8-2SbWK5qT3yrAlKnGXVgfU6jMQhK-69girsLcNY4ZuL5SR5mU4uMO6dXJr0ImE7KzNZV6RBSrv8v3Dhn6N1Kie-BxmG5zkPGy0HKs57Rq3Zuxr-UmBHlws5PSdyMBgQ1Qtgdp_KSSTtpPDe4YfLmxRcT9-vkK3MEcViPxdcols10jAP5phn683qYUBM1PYsb7bbxK0G9q6SRc_ESZfj55OpPxIO5R7h7cO6enm81gWynxYM8z36HTG5ebxBUcXtwSr_qfibnsyaGMPqcQgyaBrJiox1cT1A6P3M7wCxOQOvsZsKbbm2TQtFCgAgMUTUyp8hS0VAKHox7aM87Oxx2Rd35X993Y7zjrqVdedoKfP-55uO8ebudwOmWBxgjwzVIIjdJCpsZ-LuIYEev4fHK_siyR9yNLMMgNMa4ZVOTCp9d2mrDDMrftyu_hpVFUeZYJsk5yO6mMOd45duJ3hmUcSNJQg5S6fOsuodXxei7hx3wXZZv0c9HJ_1Qwsy1lSkOedXVou8VwoUiDu1hWfIHeO2ZcgjDWGGy4TDeUd95pGrTFCMa38X5K0hjAGfrr_Wy5hzit6uuWGO8Y2nOgT-neaCjChVdJNkE8iOR2DPFFHIul0yYHNvHo7WNQYHnHtnLJ16dQKruDX-hlQ5UrxwpMXymJDwopPEL8Bod3Tg8lhw3kozjXv423Xxcnq6UI1_2Tt61fbs6fW6the2QVoyBLBWWxHI8aHoQK4kN-pYzpPjBQuQIh8sRBv0WeE3ArXgzCOVwq9p_I2Ldyg52FzTOJuJ7IcR6WaDZwAY4T93w8clpnsw5BcWr2zYzso4dbRHvCrLuehbdDynzwWUhuxV0Y5XgspdRq94Mu88c80Og0rTYU-ptrsvVuwFo-Mlrv-1RCj219vK-imndtJJ_NGSSODUky8dDU72nrJW1E2E7Bjk3Y5q0Z2vUCE-Jn1a3tUcvM5PG2ZIyPNrBSceujvzNlt9IrNic6Xx1giDsXJFn_tcSEIDCkr9r7YP_AsYJT1V7EiMay8kWa5AiO_QAQuH_Yory9iiOkg5_V1AoYGieKfn-wUk5rVKhUVs1Fhr_hSKen55X7rRfDlJfYLwMSn2dqaVmVY2_k_-3jD1pBkLYJkTghh2-siOfOEwid2G2QZLQp4hr1rv4PpoqKQMBCWlcLjU45ZkCH6vJgS5MDnAbei8SnvbnmG0MZYJkPvLwQkuuWYCt42mJ_gCWdXv0uVbzg5bBUZwuiQ2FsehhejDD3J6yjEDC0Ib1_4gKXkb0COJlqIYK2NsHXrHvIeuvhrZHMDLodx4O3C0efny4s3A1pClZ1cZBluK1r1IzSL3QmJ9upQ7jx5Y6x1hyj6DbJKVT8ldvqX3Fs1XDP7D0jhn11eLy3OawR1r7OPY1PNwTojkj535Lz6E1KBGmgMh0sdr-g5c4chs7FO5IwPR-0PsOP9ZQFZG_cA1up7IG-JYWOnnc7zkuf7azQ8RLjoLHH18msvR59KlTVTc3v3wvvquxMoMBktf2jVw9dZQHNu4veHMpdD7prfgk79dRxhuzg8aMRqFS_QuD10USkt8CB48H-RLqwigz40YAQOVW_0ITwDLGpGI1LEFLTquHXa4gmISZznWWb20334pEumhK6-FySRVhOsP4AybCivZwsEj0jzOQz7DjDYkAL8XRfx6RPGqC3hvevOGM5Nkmk3vFmtS6y6jMQxnkR_z9OQ4stD115p7NVVZ5d1JeqAcbL3SM3PeG6Ws30jnZgsYV3424nWjndAzkApaCzewek4KzYGs5ixXGWLbQaSLQ01g9ho8NnzULtYrltBeiROt90wM3ccV4mjkBuC7UocGzF00OrZZ_dcXRIYSEfUDl18bjW5930In91MMldGd8IZF8WdUxMcMAKT9vntfbeMoMhe7ZlITNn0PtDdxWZ12gsV7x1TT_hSvw8YATaUZ4bu2rPNm_NJHpjptYzAJoqHO7bwmHM9B3ZYpr6PQxyRGt-qfgENW2EG6mAeU1BTEKN_KecdcqwORR8cWDRQLAPHvB5pKnyAzo9pf6Ca6yBRVULPI447I7A8l3qt27DG9XB2OBR7SnU2fnQ2O17A==.3bGQ-SloRO2PcgEMKmcBmWrKpvJDS_WFDuX-Yq75jrw=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.RXlVcnNHWEZMT3F5M2o5RA==.rQSyq31HENKzdujFbSJDpA==.zJKxsWiKzTmkzveEr1EZ-3xM2dK4J1qocUlPgNj3EHgtdwc1cSawOLxCAXZvhO4KoJq-LqWwjvU9dCbhTwULE1PESr6Q9_r8447urAc1YgUo_UyjuFWRFrh-rPUTGKghu6dnTxEmWSzxBFS_HZFU9waly0Q0DmgFDien8y_aaAwZiYl7ag8yZ_MkcbaK2rqnK2ZgscyWN7dvgISgocsGcdM2gkrh3aOunVSU_kjdEtFglPAQoxJ1ujsiTfEVfBXGaa_HPhqsHmH6bU_vQAfMtdvYyzjoSGZV9qFO-rIY7IoVAms1e8dDDoFNuzod7xbCM9_IwnNZU3O1zH4ELjy6Piojf_fHX0ziBSXQIA_I8_Y6U6ZV2d347ONGakAWSoRsjhMLX1U8uNv3sXZOfZtNB7oF85XVAdHwxt1jZPm6wS4jjYVvLI4gqAvxAXQDWzTfPijy74dMSQo00WzEVznKlG1ETTl2aco9iQQWWhJ5Ooz_wqOzVOZNWuQ3y9KDd1cS6ui66yRSd3kG1z9ZqCjegQKf6zx_pzpQCy26UKyTWgIA11JZzo9fyHUQ-bLb80PvmdZeFn30DHPxc0D8nh7Uni1CcPIltVDBHL0OVNAQhPuB9HOJJ5JHWp3NHKBpwMbMBBeL2ydV7KbWnyDplgEIdoOL0AVCL8_JShAkN6qmDO4pNcfSwbjM4MkfRFy_tqAsyELmdpMMWDqcU6cwsUeiHgjdMJSs969OiKVUcQgMcJP6OYQA-t8jYUFPCEmU-GNMC9TyL7-ItmSsqGvuLMIiY3mchIu6A_Td3rCJoHByZpY2jrUtkMPTKQvk1IrtlS91026QJmM0HqhX7t_p5g9cUMESeHRWpvua7zhLyrhKUhG4zMxRsIsfsx86n4Zp2Eb4bll3OmWMESEwcKhVTBzJAmOJUmJ6QbxN5pSoPObbmd3BEGCu8nsFoKepD0H-z67JqqQl5oj0UIbsrEwVq5nh30lcs54IMICrisXmsOB6f1LBSBqv4J3I_5bhyIBi-qtTqpYKe-kYqyl8yiDBUTSbqQ6RAjifWRF3FfyvumYLRiQpHymGsp7GjpQIXz1oG9H72uYeQkfS2uZMXMozailiS0GCLqbUgrx1cJdcw9xmMuuLWW3rxMW_tWLw0zWAhv75d0iZOWPf6KSgTAEcw2KaOWtAvZJ0h9jhj8Dqber_v0p0hNXxjiyjpiEDGljDuGgMvNo3ZBeADi0kptd98AzIzaHcANcDFjvRQKCfKkY2dYSGKHKOUcWv-NlHTC4oV3bTotOEjxmq4xfua4UeB0Nq07FNG4E-CMOLsKlumxuklHBR7_-hFD3Y-6SxvptzNZnDpPCIPYCpXNy7ThSP1KG8GavOy8d2vSDqpHdTc_TPdG_MK3OGe4xY-S6tYaa8yFwpjLfI7Wug_jo6Vd3OwwoDZoww8g_r-zok-un4EQ5b6qBEZZdzDiBXSqXz058aUWovbReOAIJ6v9qdf2s_YCvo985V1-mcDwolbA86gpdsyCBiNZfu3GNuX2zvVS81u1TEnH0_dFFsjFxrbvFo6oH-tfuXp62bxq7KvdCYX_mizJ9Uvs6K4BO157BW93PJLwG35CQ8H6D_EKmvOk_sWyJxjgD3Ye1AxdSWjbjUfzryEZwUOoKclou93V19_or1VKprz6_ZlnIU6XVTISLG1uy9H_w6USiPdrluL2SCpX_wck2q8yazl_yMgAZcrBUwSmL-dY-DUSOY9AY4mzJ5vRRm_jb9A45w1JkK0CpMjMdhSzwDqqfnh2Djiabf6itN8Ay8IEMvRzkq0qq1Z4zQwiOMDwtgGKOSmmhOSJHg8w2weIjBse-Q1qUlpPKfcEg8HaEMcIKejSe3328a_Ist1Sk6mWSqqgbeNuc5G9fY1KjWMJTGkWJgri1EHNNM4HqKQjNcnO-mIaG1db3B4igmu2I22kx63T2jANzmXCK4wlXCoZJmQhi19CXt0SEuVtOkDnErnuawibLa45Z0fxhObZM1zoFUReUEyExl8b3AOh7oE2NmqJug7EwXUC3JjCoxum4W3BSh0oProps-dGiNDkOE4BBUMTlsaFS8Rmix2_NXovv7mhZluz39zkn1N5gT-9bSGxaR5O1YR29Rzmjqq-FHoSC0SrPG7Xg7WtMuQTrRaz87QsT6y-ChsC4htm1xV-mlkO6oFtcKspXLIEtH_1SQay3PXPVXP0_w7pRubaGzvr4-cpYfVVhlwkuhr3cZIEuFRHQpnPk6R_vQmNPZGLPPjQHrFwF3nu7eoPNgNLXg93Ht4zalVKQ01GEwkncE4OHohX0JurKaqy_0iVvabFz3KaYRVGaIO39GR52dU_e0h_Im50BN4W-zP6dBljqPsrd6JBI23Gxqy6NFJi2QGOxA5xTFjWM44irusDK1a-DtILnZcHV6GykLRjH-bhFA4M7V7v2ARXG5trBfgkQRAln-QBvQ6667K4bdJTXpqriVr4hxmr8toz3nonQDvTs5RD9eAuBaYRuHUSeuIf660sPx01lRfJfKiL0RrvgRPM6Yn2A6xxmL82IYrnSnC08mzjKdQm71P8LkdHLlEo6KLp9S9AVcDtm-HxOeR-B-8qPOPalwwTFcr2_l5Cg5Mw0GSlpXbLxxrm-XrPbpze57VRDZ5e1lJ81Q1OddexhPAJK44j81y0ZCkrC1T3mnMP7nUpHKcLU4AMvzZHP8ssYsmWL-A6uKkxnGYmbHVwqXoK0FVcufwyd_Un4RntbOEZlqI8S42FMLihfa-hFVX8SUBCWXsHHVtHpPTB8z1NalAHS7eoZrHXCrcf_BNW7o1mFoK6J7LLfoQXSa-JByX_Huk4ICxjJGuVz4l3qGzCvEtvCZ6UewLhgy7_goLfP2rLJmW8KdGtJScCn7TdOqwexMW08Cdo2sUsujtbSUKvNBb9UAvxtWtfHxyDLQsZlRvUIhcqaoaW-kmiY_0tnn_0nMPpX8k1h-2cdQUnEpUaZPRZdvSt6qeWdOKGCxlycgubs3p26WpvXCm7qzZSfQgYeg7JzryGT6DIZ4W-RLlzz4s0YOwOzj-r6a-D2zMOeYv0YEZlPRAXeSEkQsdz_yOHxr5j6HvOX-PNDQ5MRy80XoANJgZ8an4G1cfB7dK2sjrwwNRg8MKkHVKeYF87EQbHlm1bFPJu8dFmulWgx_rkuHXGD20dNp6_oX59FdwiYpYJOm9e3V9r6nGzGCA0YM9Iof_svpARgrbnUcFCECf8P6tgzZb3lLvQYT0snsXtwT4acF966Qt7PF0I3ZMcZzcr5YD1Ef6yl5IPCY5EOfqQkvIAtW8U8R3DugmQmh6OaOOhZqGP3Dqh2Qyiqs-nNHmejY6S_tcmr8fd75qKuyvvbhXKjfznGkcTt7DUi3E9xuAIrk-zNJWnjyl54g0CaJuVDNhX9k4wIpDDdunLw7OPikifu989iIy4r21RF2OP6qikCLFnQ1-PNkDQI7z6jGRT0VoNQ5BFCOsnX965QwvZ6xnwC41dSHCayYwDx-gk74Bhl7aevnrHO-k2q5FyuG2uvvsjMvkVk6xOj-6tZIQz2AiHk99c4VUWUtEUW6VgXXa-aWoy6r2IEWoI8XJ8_MNAk6tmqcEA==.Wh8ZkTulr3LEyMTh2q4gVCbq2Bx8nP2DGSyX6W0VnAo=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.Q1FJbXpIalRrWGMwMVpQeQ==.OmTK1ikeHFB5NTQuj0Rgzg==._eotGevon8kBnt2Qx6tnDCgatP2o2pXUhdZD3jkT-MG0pXxMJFgX8XUwFlanqJfeykc_QqNM817lnlNrA1r0k4dU_oZ0dT8j0F1XxdV0U0ODQCvUwZqa0XiEwwMK0omC6jPhUSPer1N7n9HCVIbOlMrCXwrDWAnDX25IBrSGyet9aE95q5gWB3AnBVvpruiMmg4MxYRwgy43smdBSAx4AGrn0Tu1GmwYHWZVyk0TRmmV1i85cW21VUCQ2e5MCZDqz0SkpaXKcnZFgv3LQCnMsEGSnLNWBpp9TiPsB9rdl3-kmoHeTv1K6zZjq6gEXeM6spbxLM7K-bK1ZLYIdHPs8wmvxkejE1uc0jlXrt7JICjGkgNG6ZocP_CTGyBUhVcWyzGvJvETT7AEEyqswEE0jVFdz849pK-iL_qF5wUNvoy_FwomKek11dAsbUfGS87lBfQmeeB-_h2ZY0DDWdvCH7_5tAGyuKkU5QQegM5OKpQhxt4NK_L8BV0d8Sg2-KrFwwKWVpSqay9tOfzkUjWvpy8bssQQkBdUF4AYX_1i5uloa56OaSKkH08xNyNvmn5gS0cmwpl3LOHi3OwmDga0jvBHEZH4tSwY5POH0j-T1DX9iO2F_gOeaEOT8cyVj2CliAMgDuv3Zx7Eii3wGVs4njp2pLUgtHa7AFPh5g6KScbwwn8VkKzw8Clv6WnJY2rU49iF9iBOR-yYgkVnvu6cm6ipobb1lLCA3Rd_AjNrnZ2-9P4Ns664aFm9545qP9natZoarEx9PdwPRbgcMT0UInJl8Bkf9tDkdpud3WriikWBaxPT-EZBidyVgBZthntPTwL-mHsdWIDE3NDWUGHEBp5gPtfOwT7rDahEcMYrC-w4w8LWjIH7gkDUHFS-r7MVcqzfLlgqBNcNgz_uq5nLAouaVYi3lB2ySWmRn5WxO8jKFHsEKrtUTX4k1d4YAbko3cYeB_XO_snxPZ1bxzy27UtJqijUY3tKGk8T_NSbcdX4kWLSnqnD5CJLsATxJa1xspy9_PTHEmySSmSvid9CSefznaYdol4lSoENiIZj5UGpttCp3mPyPnLNV5AUxSW4BdRg-mPMKx-yfJ_iObNg1YFc9MZDaed0uJ1xdI3miYK93gtWPY5KirZvScyByI_YuwYg1DIkfwuE-yihPi09fI-GWKFPz__egIvdb3RoJXZBfeKC3FPEr4-KAPu3BNFfQfERhnAc9DLkttSED2uPpOueyOGOxFnK6Q9cqh-XUIpkdWZa4yfCUxR6kQM7bxvvN2q12InIhPVMiI25vhe4gbn53G6lmKmfEhAhA6_fo38QHxX2ooX1k_sYxFordYhR0O74Y0uznHzasy5F6YiwkK46pJtB_XD7bClHfWuQwKxxHuSqMThB41NzDAPx47yRJfaa8lWVlZsdfaP5t-jN-uw0OVBdAKp0dsi35s8jZgbDp8duXds7-iW6Pc6uQaEg0NQWitmDRQycugBaMESzC15IEjWiw1AztsB86SDVYx-GQzkFf5s9TLuVSHyEqV3PVK9DtBDNvqTLvHOAPh2IxyorrRjxHnhEAVlb4kBRhBlLiFt3gjDfXyWsCFEPdOFB4nJ9QOLsmtORWF6OH_1ROw==.k6J2sv8Wl2DtBDmaPqiypL13zZil2EXIcyC4-XLsgJQ=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <authorization-managers>
      <authorization-manager>
        <id>opa-authz-mngr</id>
        <opa-authorization-manager xmlns="https://curity.se/ns/ext-conf/opa-authorization-manager">
          <http-client>
            <id>opa-http-client</id>
          </http-client>
          <opa-host>opa</opa-host>
          <opa-path>/v1/data/curity/</opa-path>
          <opa-port>8181</opa-port>
        </opa-authorization-manager>
      </authorization-manager>
    </authorization-managers>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$iP3vJpIj$c.ZEStVuRenQvI.5P9DpBV9fNBs2E9ckBAhZ37Lsvh3</password>
          <ssh_keydir>/Users/iggbom/curity/idsvr-7.3.1-xacml/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/Users/iggbom/curity/idsvr-7.3.1-xacml/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>